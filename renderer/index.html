<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Tailor AI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
</head>

<body>

  <!-- ================= SIDEBAR ================= -->
  <aside class="sidebar" id="appSidebar">
    <!-- Toggle Button -->
    <div class="sidebar-toggle" id="sidebarToggle">
      ‚Äπ
    </div>

    <div class="sidebar-header">
      <h1>
        Tailor AI
        <span class="sidebar-brand-badge">BETA</span>
      </h1>
    </div>

    <nav class="nav-links">
      <a class="nav-item" data-view="view-dashboard">
        <span class="nav-icon">üìä</span>
        <span>Dashboard</span>
      </a>
      <a class="nav-item active" data-view="view-test-manager">
        <span class="nav-icon">üß™</span>
        <span>Test Manager</span>
      </a>
      <a class="nav-item" data-view="view-settings">
        <span class="nav-icon">‚öôÔ∏è</span>
        <span>Settings</span>
      </a>
      <a class="nav-item" data-view="view-review-manager" id="nav-reviews" style="display:none;">
        <span class="nav-icon">üëÄ</span>
        <span>Reviews</span>
      </a>
      <a class="nav-item" onclick="window.logout()" style="margin-top: auto;">
        <span class="nav-icon">üö™</span>
        <span>Logout</span>
      </a>
    </nav>

    <div class="sidebar-footer">
      v1.2.0 ¬∑ Internal QA Tool
    </div>
  </aside>

  <!-- ================= MAIN CONTENT ================= -->
  <div class="main-content">

    <header>
      <!-- Header content if needed, currently empty or just breadcrumbs could go here -->
      <div style="font-weight: 600; color: var(--text-primary);" id="page-title">
        Test Manager
      </div>
    </header>

    <div class="view-container">

      <!-- ===== VIEW: DASHBOARD ===== -->
      <div id="view-dashboard" class="view">
        <div class="placeholder-view">
          <div class="placeholder-icon">üìä</div>
          <h3>Dashboard Coming Soon</h3>
          <p>Analytics and reporting features are under development.</p>
        </div>
      </div>

      <!-- ===== VIEW: TEST MANAGER (Existing) ===== -->
      <div id="view-test-manager" class="view active">
        <div class="container">
          <!-- LEFT PANEL -->
          <div class="panel">
            <div class="panel-toolbar">
              <h2>Azure DevOps</h2>
            </div>

            <label for="org">Organization URL</label>
            <input id="org" placeholder="https://devops.det.gov.ae/DefaultCollection" />

            <label for="pat">Personal Access Token (PAT)</label>
            <input id="pat" type="password" placeholder="Enter your Azure DevOps PAT" />

            <p style="font-size: 11px; color: var(--text-muted); margin-top: 4px;">
              Create PAT in Azure DevOps: User Settings ‚Üí Personal Access Tokens
            </p>

            <label for="projects">Project</label>
            <div style="display: flex; gap: 8px; margin-bottom: 16px;">
              <select id="projects" style="flex: 1;"></select>
              <button id="loadProjects" class="secondary" style="padding: 4px 12px;" title="Reload Projects">‚Üª</button>
            </div>

            <div style="margin-bottom: 8px;">
              <label style="margin-bottom: 4px;">Current Context</label>
              <div id="currentContextDisplay" class="context-box">
                No Plan or Suite selected.
              </div>
              <button id="openSuitePickerBtn" style="width:100%;" disabled>Select Plan & Suite</button>
            </div>

            <button id="createSuite" class="secondary" style="width:100%; display:none;">+ Create New Suite</button>
          </div>

          <!-- RIGHT PANEL -->
          <div class="panel">
            <!-- Toolbar -->
            <div class="panel-toolbar">
              <h2>Test Cases</h2>
              <div style="display: flex; gap: 8px;">
                <button id="exportExcel" class="secondary">Export Excel</button>
                <button id="importExcel" class="secondary">Import Excel</button>
                <button id="submitTestCases" title="Push directly to Azure">Add New Test Cases</button>
                <button id="saveDraftBtn" class="secondary"
                  style="display:none; border: 1px solid var(--accent-primary); color: var(--accent-primary);">Submit
                  for Review</button>
                <button id="addNewTestCase" class="secondary">+ Add New</button>
              </div>
            </div>

            <div id="testCaseTable" class="table-wrapper">
              <div class="empty-state">
                <div class="empty-icon">üß™</div>
                <h3>No Test Cases Loaded</h3>
                <p>Follow these steps to get started:</p>
                <ol class="empty-steps">
                  <li>Enter your <strong>Organization URL</strong> and <strong>PAT</strong>.</li>
                  <li>Select a <strong>Project</strong> from the dropdown.</li>
                  <li>Click <strong>Select Plan & Suite</strong> to choose your test cases.</li>
                </ol>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ===== VIEW: SETTINGS ===== -->
      <div id="view-settings" class="view">
        <div class="placeholder-view">
          <div class="placeholder-icon">‚öôÔ∏è</div>
          <h3>Settings</h3>
          <p>Application preferences will appear here.</p>
        </div>
      </div>

      <!-- ===== VIEW: REVIEW DASHBOARD (Leads Only) ===== -->
      <div id="view-review-manager" class="view">
        <div class="container" style="flex-direction: column;">
          <div class="panel-toolbar">
            <h2>Pending Reviews</h2>
            <button id="refreshReviewsBtn" class="secondary">Refresh</button>
          </div>
          <div id="reviewList" class="review-grid">
            <!-- Reviews populated here -->
            <div class="empty-state">
              <h3>No Pending Reviews</h3>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- SCRIPT -->
  <script type="module" src="./modules/main-renderer.js"></script>

  <!-- Datalist -->
  <datalist id="projectUsersList"></datalist>

  <!-- SUITE PICKER MODAL -->
  <div id="suitePickerModal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modalTitle">Select Test Plan</h3>
        <button id="closeSuitePicker" class="secondary" style="padding: 4px 12px;">Close</button>
      </div>
      <div class="modal-body">
        <div id="modalBackContainer" style="margin-bottom:12px; display:none;">
          <button id="modalBackToPlans" class="modal-back-btn">‚Üê Back to Plans</button>
        </div>
        <div id="modalTreeContainer" class="suite-tree-container"></div>
      </div>
    </div>
  </div>

  <!-- CONFIRM REVIEWER MODAL -->
  <div id="reviewerModal" class="modal-overlay" style="display: none;">
    <div class="modal-content" style="max-width: 400px;">
      <div class="modal-header">
        <h3>Select Reviewer</h3>
        <button id="closeReviewerModal" class="secondary" style="padding: 4px 12px;">Close</button>
      </div>
      <div class="modal-body">
        <p style="margin-bottom: 12px; font-size: 13px; color: var(--text-secondary);">
          Please select a Lead from your organization to review this test case.
        </p>
        <label for="reviewerSelect">Assign To</label>
        <select id="reviewerSelect" style="width: 100%; margin-bottom: 20px;">
          <option value="" disabled selected>Loading Leads...</option>
        </select>
        <div style="display: flex; justify-content: flex-end; gap: 8px;">
          <button id="confirmSaveDraft" style="background: var(--accent-primary); color: white;">Save & Assign</button>
        </div>
      </div>
    </div>
  </div>

  <!-- TOAST CONTAINER -->
  <div id="toast-container" class="toast-container"></div>

</body>

</html>